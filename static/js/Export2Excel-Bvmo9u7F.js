function e(){if(!(this instanceof e))return new e;this.SheetNames=[],this.Sheets={}}function t(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=255&e.charCodeAt(n);return t}const r=({multiHeader:r=[],header:n,data:s,filename:a,merges:l=[],autoWidth:o=!0,bookType:h="xlsx"}={})=>{a=a||"excel-list",(s=[...s]).unshift(n);for(let e=r.length-1;e>-1;e--)s.unshift(r[e]);var c="SheetJS",i=new e,f=function(e,t){for(var r,n={},s={s:{c:1e7,r:1e7},e:{c:0,r:0}},a=0;a!=e.length;++a)for(var l=0;l!=e[a].length;++l){s.s.r>a&&(s.s.r=a),s.s.c>l&&(s.s.c=l),s.e.r<a&&(s.e.r=a),s.e.c<l&&(s.e.c=l);var o={v:e[a][l]};if(null!=o.v){var h=Xlsx.utils.encode_cell({c:l,r:a});"number"==typeof o.v?o.t="n":"boolean"==typeof o.v?o.t="b":o.v instanceof Date?(o.t="n",o.z=Xlsx.SSF._table[14],o.v=(r=o.v,(Date.parse(r)-new Date(Date.UTC(1899,11,30)))/864e5)):o.t="s",n[h]=o}}return s.s.c<1e7&&(n["!ref"]=Xlsx.utils.encode_range(s)),n}(s);if(l.length>0&&(f["!merges"]||(f["!merges"]=[]),l.forEach((e=>{f["!merges"].push(Xlsx.utils.decode_range(e))}))),o){const e=s.map((e=>e.map((e=>null==e?{wch:10}:e.toString().charCodeAt(0)>255?{wch:2*e.toString().length}:{wch:e.toString().length}))));let t=e[0];for(let r=1;r<e.length;r++)for(let n=0;n<e[r].length;n++)t[n].wch<e[r][n].wch&&(t[n].wch=e[r][n].wch);f["!cols"]=t}i.SheetNames.push(c),i.Sheets[c]=f;var g=Xlsx.write(i,{bookType:h,bookSST:!1,type:"binary"});FileSaver.saveAs(new Blob([t(g)],{type:"application/octet-stream"}),`${a}.${h}`)};export{r as export_json_to_excel};
