import*as e from"xlsx";function t(){if(!(this instanceof t))return new t;this.SheetNames=[],this.Sheets={}}function r(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=255&e.charCodeAt(n);return t}const n=({multiHeader:n=[],header:a,data:o,filename:s,merges:l=[],autoWidth:h=!0,bookType:c="xlsx"}={})=>{s=s||"excel-list",(o=[...o]).unshift(a);for(let e=n.length-1;e>-1;e--)o.unshift(n[e]);var i="SheetJS",f=new t,g=function(t,r){for(var n,a={},o={s:{c:1e7,r:1e7},e:{c:0,r:0}},s=0;s!=t.length;++s)for(var l=0;l!=t[s].length;++l){o.s.r>s&&(o.s.r=s),o.s.c>l&&(o.s.c=l),o.e.r<s&&(o.e.r=s),o.e.c<l&&(o.e.c=l);var h={v:t[s][l]};if(null!=h.v){var c=e.utils.encode_cell({c:l,r:s});"number"==typeof h.v?h.t="n":"boolean"==typeof h.v?h.t="b":h.v instanceof Date?(h.t="n",h.z=e.SSF._table[14],h.v=(n=h.v,(Date.parse(n)-new Date(Date.UTC(1899,11,30)))/864e5)):h.t="s",a[c]=h}}return o.s.c<1e7&&(a["!ref"]=e.utils.encode_range(o)),a}(o);if(l.length>0&&(g["!merges"]||(g["!merges"]=[]),l.forEach((t=>{g["!merges"].push(e.utils.decode_range(t))}))),h){const e=o.map((e=>e.map((e=>null==e?{wch:10}:e.toString().charCodeAt(0)>255?{wch:2*e.toString().length}:{wch:e.toString().length}))));let t=e[0];for(let r=1;r<e.length;r++)for(let n=0;n<e[r].length;n++)t[n].wch<e[r][n].wch&&(t[n].wch=e[r][n].wch);g["!cols"]=t}f.SheetNames.push(i),f.Sheets[i]=g;var u=e.write(f,{bookType:c,bookSST:!1,type:"binary"});FileSaver.saveAs(new Blob([r(u)],{type:"application/octet-stream"}),`${s}.${c}`)};export{n as export_json_to_excel};
